<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title id="title">ClouDrop</title>
    <!-- Materialize CDN -->
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.css">
  <link href="css/style.css" rel="stylesheet">   
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <!-- firebase CDN -->  
  <script src="https://www.gstatic.com/firebasejs/6.6.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/5.9.1/firebase-auth.js"></script>   
  <script src="https://www.gstatic.com/firebasejs/6.2.0/firebase-firestore.js"></script>
  <script src="https://www.gstatic.com/firebasejs/6.2.0/firebase-storage.js"></script>
  
</head>
<body>
  <p id="uid" hidden></p>

  <div class="navbar-fixed">  
    <nav class="nav-cl hamburger-menu-background">
      <div class="nav-wrapper">
        <a href="#!" class="brand-logo">Blocked Book</a>
        <a href="#" data-target="mobile-demo" class="sidenav-trigger"><i class="material-icons">menu</i></a>
        <ul class="right hide-on-med-and-down">
          <li><a class="waves-effect waves-light radius btn cl-btn-light" href="./Logged.html"><i class="material-icons left">home</i>Inicio</a></li>
          <li><a class="waves-effect waves-light radius btn cl-btn-light" href="./tipoLibro.html"><i class="material-icons left">book</i>Tipo Libro</a></li>
          <li><a class="waves-effect waves-light radius btn cl-btn-light" href="./Prestamos.html"><i class="material-icons left">event_note</i>Prestamos</a></li>
          <li><a class="waves-effect waves-light radius btn cl-btn-light" onclick="LogOut()"><i class="material-icons left">exit_to_app</i>Salir</a></li>        
        </ul>
      </div>
    </nav>  
  </div>
  
    <ul class="sidenav hamburger-menu-background" id="mobile-demo">    
      <div class="center-align">   
        <br>
        <a class="waves-effect waves-light radius btn cl-btn-light-hamburger-menu" href="./Logged.html"><i class="tiny material-icons left">home</i>Inicio</a>
        <a class="waves-effect waves-light radius btn cl-btn-light-hamburger-menu" href="./Prestamos.html"><i class="material-icons left">event_note</i>Prestamos</a>      
        <a class="waves-effect waves-light radius btn cl-btn-light-hamburger-menu" href="./tipoLibro.html"><i class="material-icons left">book</i>Tipo Libro</a>      
        <a class="waves-effect waves-light radius btn cl-btn-light-hamburger-menu" onclick="LogOut()"><i class="material-icons left">exit_to_app</i>Salir</a>     
      </div>    
    </ul>
<!-- FASE BETA DE UN BUSCADOR -->
<!-- <input type="text" id="palabra">
<button onclick="BuscarRegistro()">Buscar</button> -->


<br>
  <div class="left-align">
  <a class="waves-effect waves-light btn modal-trigger btn cl-btn-light radius href="#modal1">
    <i class="material-icons left">add</i>Agregar</a>
      <br>              
  </div>

  <div class="row">
    <div class="col s12 m12 l12">
      <div id="divTipoLibro" class=""></div>
    </div>
  </div>

  <!-- Modal Agregar Libro -->
  <div id="modal1" class="modal modal-fixed-footer radius">
    <div class="modal-content" id="modalScrollAdd">
      <h4>Agregar Libro</h4>
 <div class="container" id="imageBackground">
   <div class="row">
    <div class="col s12">
      <div class="row">
        <div class="input-field col s12">
          <i class="material-icons prefix">vpn_key</i>
          <input type="text" id="idBook" disabled>
          <label>ID</label>
        </div>
        <div class="input-field col s12">
          <i class="material-icons prefix">book</i>
          <input type="text" id="nameBookAdd" placeholder="Nombre De Libro">
          <!-- <label>Nombre De Libro</label> -->
        </div>
        <div class="input-field col s12">
          <i class="material-icons prefix">description</i>          
          <textarea  id="descriptionBookAdd" class="materialize-textarea" placeholder="Descripción Del Libro"></textarea>        
        </div>                                          
          <center>
            <p style="color: #9E9E9E;">Portada De Libro</p>            
          </center>              
          <!-- Header de Portada Libro -->
            <div class="card-tabs grey darken-2" style="border-radius: 20px 20px 0px 0px;">
              <ul class="tabs tabs-fixed-width tabs-transparent">
                <li class="tab"><a class="active" id="tabActiveAdd" href="#testWithImage" style="border-radius: 20px 0px 0px 0px;">
                  <i class="material-icons prefix">image</i></a></li>
                <li class="tab"><a href="#testWithoutImage" onclick="NotImageAdd()" style="border-radius: 0px 20px 0px 0px;">
                  <i class="material-icons prefix">not_interested</i></a></li>      
              </ul>
            </div>  
            <!-- Body de Portada Libro -->
            <div class="card-content grey lighten-1" style="border-radius: 0px 0px 20px 20px;">
              <!-- Opcion agregar libro -->
              <div id="testWithImage" class="center-align">    
                <br>            
                <img src="file:///C:/xampp/htdocs/login-firebase/tipoLibro.html" id="imageBookPreviewAdd" width="200" height="200" class="BookPreview"/>                      
                <div class="flexImage">
                  <div>              
                    <input type="file" accept="image/*" id="imageBookAdd" onchange="UploadImageFromAddBook(this)">   
                  </div>
                </div>  
              </div>
              <!-- Opcion NO agregar libro -->
              <div id="testWithoutImage">                
                   <br>
                <center>
                  <img src="img/SinImagen.jpg" width="200" height="201" class="BookPreview"/> 
                </center>        
                <br>        
              </div>                  
            </div>            
       <!-- <button onclick="Hola()">Click Me!</button>
      <script>
        function Hola(){
        obFoto = document.getElementById("descriptionBookAdd").style.height;    
        alert(obFoto);
        }    
      </script>               -->
        </div>    
      </div>
      <a class="waves-effect waves-light btn grey darken-2 radius" onclick="AddBook()">
        <i class="material-icons left">add</i>Agregar Libro</a>
    </div>
  </div>        
</div>          
    <div class="modal-footer">
      <a href="#!" class="modal-close waves-effect waves-gray btn-flat" id="CancelarAdd" onclick="CardAddReset()">Cancelar</a>
    </div>
  </div>

         <!-- Modal Editar Libro -->
  <div id="modalEdit" class="modal modal-fixed-footer radius">
    <div class="modal-content" id="modalScrollUpdate">
      <h4>Editar Libro</h4>
 <div class="container">
   <div class="row">
    <div class="col s12">
      <div class="row">
        <div class="input-field col s12">
          <i class="material-icons prefix">vpn_key</i>
          <input type="text" id="idBookUpdate" disabled>
          <label></label>
        </div>
        <div class="input-field col s12">
          <i class="material-icons prefix">book</i>
          <input type="text" id="nameBookUpdate">
          <label></label>
        </div>
        <div class="input-field col s12">
          <i class="material-icons prefix">description</i>
          <!-- <input type="text" id="descriptionBookEdit"> -->
          <textarea  id="descriptionBookUpdate" class="txta materialize-textarea"></textarea>
          <label></label>
        </div>

        <script>
          function Alert(){
            alert("Hola");
          }
        </script>

        <center>
          <p style="color: #9E9E9E;">Portada De Libro</p>            
        </center>              
        <!-- Header de Portada Libro -->
          <div class="card-tabs grey darken-2" style="border-radius: 20px 20px 0px 0px;">
            <ul class="tabs tabs-fixed-width tabs-transparent">
              <li class="tab"><a class="active" id="tabActiveUpdate" href="#testWithImageUpdate" style="border-radius: 20px 0px 0px 0px;">
                <i class="material-icons prefix">image</i></a></li>
              <li class="tab"><a href="#testWithoutImageUpdate" onclick="NotImageUpdate()" style="border-radius: 0px 20px 0px 0px;">
                <i class="material-icons prefix">not_interested</i></a></li>      
            </ul>
          </div>  
          <!-- Body de Portada Libro -->
          <div class="card-content grey lighten-1" style="border-radius: 0px 0px 20px 20px;">
            <!-- Opcion agregar libro -->
            <div id="testWithImageUpdate" class="center-align">    
              <br>            
              <img src="file:///C:/xampp/htdocs/login-firebase/tipoLibro.html" id="imageBookPreviewUpdate" width="200" height="200" class="BookPreview"/>                      
              <div class="flexImage">
                <div>              
                  <input type="file" accept="image/*" id="imageBookUpdate" onchange="UploadImageFromUpdateBook(this)">  
                </div>
              </div>  
            </div>
            <!-- Opcion NO agregar libro -->
            <div id="testWithoutImageUpdate">                
                 <br>
              <center>
                <img src="img/SinImagen.jpg" width="200" height="201" class="BookPreview"/> 
              </center>        
              <br>        
            </div>                  
          </div>  

        <!-- BAKEND  -->
        <div class="" id="Backend">
        <label>Nombre de imagen a borar después de actualizar el libro si se cambia:</label>
        <p id="nameImageToDeleteBeforeUpdateBook"></p>

        <label>URL de libro actual (Se modifica cuando el usuario cambia la imagen)
              (Elimina la imagen anterior si se cambia la imagen)</label>
        <b><p id="URLActualBook"></p></b>

        <label>URL fija de la imagen del libro A editar (Con esto se hace la comparación entre
               la URL del libro actual)</label>
        <p id="URLFixedImageToCompareWithActualBook"></p>
        </div>
      <!-- END BAKEND  -->

      </div>
      <button onclick="Hola()">Click Me!</button>
      <script>
        function Hola(){
        obFoto = document.getElementById("imageBookPreviewUpdate").src;    
        alert(obFoto);
        }    
      </script>
      <a class="waves-effect waves-light btn grey darken-2 radius" onclick="UpdateBook()">
        <i class="material-icons left">done</i>Guardar Cambios</a>        
    </div>
  </div>        
  </div>      
    </div>
    <div class="modal-footer">
      <a href="#!" class="modal-close waves-effect waves-gray btn-flat" id="CancelarUpdate" onclick="CardUpdateReset()">Cancelar</a>
    </div>
  </div>  
  
  <!-- Modal Eliminar Libro -->
  <div id="modalAntiDelete" class="modal radius">
    <div class="modal-content">
      <h5>¿Seguro que deseas Eliminar este libro?</h5>
      <p>Esta accion no se puede deshacer</p>
 <div class="container">
   <div class="row">
    <div class="col s12">
      <div class="row">
        <div class="input-field col s12">
          <i class="material-icons prefix">vpn_key</i>
          <input type="text" id="idBookDelete" disabled>
          <p id="nameImageToDeleteBook"></p>
          <label></label>
        </div>      
      </div>
      <center>
      <div>
      <a class="waves-effect waves-light btn grey darken-2" onclick="Delete()">
        <i class="material-icons left">delete</i>Eliminar</a>        
      </div>
</center>
    </div>
  </div>        
  </div>      
    </div>
    <div class="modal-footer">
      <a href="#!" class="modal-close waves-effect waves-gray btn-flat" id="CancelarDelete">Cancelar</a>
    </div>
  </div>  

<script>
    // Your web app's Firebase configuration
  var firebaseConfig = {
    apiKey: "AIzaSyAvJcXJAvbIdc0KfJLH3CyQ0gvnP1sHKF0",
    authDomain: "cld-beta.firebaseapp.com",
    databaseURL: "https://cld-beta.firebaseio.com",
    projectId: "cld-beta",
    storageBucket: "cld-beta.appspot.com",
    messagingSenderId: "643649556510",
    appId: "1:643649556510:web:7388c54638e3321944de0f"
  };
  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);

  firebase.auth().onAuthStateChanged(function(user) {
  if (user) {
    var displayName = user.displayName;
    var email = user.email;
    var emailVerified = user.emailVerified;
    var photoURL = user.photoURL;
    var isAnonymous = user.isAnonymous;
    var uid = user.uid;
    var providerData = user.providerData;
    console.log("Existe Usuario Activo");
    
    
    // firebase.firestore().collection(uid).get()
    // .then(function(querySnapshot) {
    //     querySnapshot.forEach(function(doc) {
    //       var tabla = document.getElementById('tablass').innerHTML;
    //         // doc.data() is never undefined for query doc snapshots
    //         console.log(doc.id, " => ", doc.data().name);
    //         console.log(doc.id, " => ", doc.data().description);
    //         var res = doc.data();
    //         tabla.innerHTML+=`<p>`+doc.data().name+`</p>`
    //     });
    // })
    // .catch(function(error) {
    //     console.log("Error getting documents: ", error);
    // });

  //Mostrar Registros De Los Libros
  firebase.firestore().collection(uid).orderBy("timestamp", "desc")
  .onSnapshot(res=>{
    listarTipoLibros(res);
  });  

  
  } else {
    window.location='../login-firebase/index.html';    
    console.log("No Existe Usuario Activo");
  }

  //Traer Datos Del Usuario
  var docRef = firebase.firestore().collection(uid).doc("UserData");
docRef.get().then(function(doc) {
if (doc.exists) {
    var user=doc.data();    
    document.getElementById('uid').innerHTML = user.uid;
    // document.getElementById('User').innerHTML = user.displayName;
    document.getElementById('ProfileUserImage').src = user.photoURL;    
} else {
    // doc.data() will be undefined in this case
    console.log("El documento no existe!");
}
}).catch(function(error) {
console.log("Error getting document:", error);
});

  });
  </script> 
  <script src="js/app.js"></script>
  <!-- Materialize -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script> 
  <script src="js/init.js"></script>

  <script src="js/tipoLibro.js"></script>
</body>
</html>








<!-- ININTANGIBLEININTANGIBLEININTANGIBLEININTANGIBLEININTANGIBLEININTANGIBLEININTANGIBLE -->


    <!-- CARD -->      
    <!-- <div class="div-base-9-1 col s12">

      <div class="row">
        <div class="col s12 m12 l12">
          <div class="card radius">
            <div class="card-image">
              <img class="image-radius" src="https://lh3.googleusercontent.com/proxy/jur5-PieA9tOppeyAjOQbUIy_x51lvvgMgVv630fZ2iifqjPk2X7F8HdSyPega8_FV6aN4LTaZiiVINdC8wkIYG_-nv6jxT0p4fTYlyHCM5_-RS8m7TfMksYZMuQKviZk0stDnwTslEZB885ZegNUPuKsFdf">
              <span class="card-title">Card Title</span>
              <a class="btn-floating halfway-fab waves-effect waves-light red"><i class="material-icons">add</i></a>
            </div>
            <div class="card-content">
              <p>I am a very simple card. I am good at containing small bits of information. I am convenient because I require little markup to use effectively.</p>
            </div>
          </div>
        </div>
      </div>    
  
    </div> 
                   -->
    <!-- NAVBAR -->
    
    <!-- <div class="div-base-9-2 col s2">
        
      <nav class="radius nab-bar">      
        <div class="nav-wrapper">
          <a href="#!" class="brand-logo">Logo</a>
          <a href="#" data-target="mobile-demo" class="sidenav-trigger"><i class="material-icons">menu</i></a>
          <ul class="right hide-on-med-and-down">
            <li><a href="sass.html">Sass</a></li>
            <li><a href="badges.html">Components</a></li>
            <li><a href="collapsible.html">Javascript</a></li>
            <li><a href="mobile.html">Mobile</a></li>
          </ul>
        </div>
      </nav>
    
      <ul class="sidenav" id="mobile-demo">
        <li><a href="sass.html">Sass</a></li>
        <li><a href="badges.html">Components</a></li>
        <li><a href="collapsible.html">Javascript</a></li>
        <li><a href="mobile.html">Mobile</a></li>
      </ul>    
  
    </div> -->

    <!-- ININTANGIBLEININTANGIBLEININTANGIBLEININTANGIBLEININTANGIBLEININTANGIBLEININTANGIBLE -->